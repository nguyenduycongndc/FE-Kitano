@using RiskAssessment.Resource;
@{
    ViewData["Title"] = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var item = 0;
}
<style>
    .row-custom {
        display: flex;
    }
</style>
<div class="row page-titles mx-0" style="padding-bottom: 0px; ">
    <div class="col p-md-0">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="javascript:void(0)">@Resource.Home</a></li>
            <li class="breadcrumb-item"><a href="javascript:void(0)">Kế hoạc kiểm toán năm</a></li>
            <li class="breadcrumb-item"><a href="javascript:void(0)">Cuộc kiểm toán</a></li>
            <li class="breadcrumb-item active"><a href="javascript:void(0)"></a>  @Resource.Create</li>
        </ol>
    </div>
</div>
<div class="container-fluid">
    <div class="card">
        <div class="card-header bg-primary text-white" style=" font-size: 1rem; ">
            @Resource.Create
        </div>
        <div class="card-body card-custom">
            <form id="form-audit-work" class="form-valide" action="#" method="post" style="margin-top: 20px;">
                <input type="hidden" id="Id" name="Id" value="0" />
                <div class="row">
                    <div class="col-md-12 row-custom">
                        <div class="col-md-12 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-2">
                                    Tên cuộc kiểm toán <span class="text-danger">*</span>
                                </label>
                                <div class="col-lg-10">
                                    <input type="text" class="form-control" id="Name" name="Name">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-12 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-2">
                                    Mục tiêu kiểm toán <span class="text-danger">*</span>
                                </label>
                                <div class="col-lg-10">
                                    <input type="text" class="form-control" id="Target" name="Target">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Thời gian bắt đầu <span class="text-danger">*</span>
                                </label>
                                <div class="col-lg-8">
                                    <input type="text" id="StartDate" name="StartDate" class="form-control" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Thời gian kết thúc <span class="text-danger">*</span>
                                </label>
                                <div class="col-lg-8">
                                    <input type="text" id="EndDate" name="EndDate" class="form-control" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Số ngày công
                                </label>
                                <div class="col-lg-8">
                                    <input type="text" class="form-control" id="NumOfWorkdays" name="NumOfWorkdays">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Người phụ trách <span class="text-danger">*</span>
                                </label>
                                <div class="col-lg-8">
                                    <select class="form-control" id="PersonInCharge">                                      
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Số lượng KTV dự kiến <span class="text-danger">*</span>
                                </label>
                                <div class="col-lg-8">
                                    <input type="text" class="form-control" id="NumOfAuditor" name="NumOfAuditor">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Phân công kiểm toán
                                </label>
                                <div class="col-lg-8">
                                    <div style="display: inline-flex; flex-direction: row; justify-content: center; align-items: flex-start; padding: 0 5px 0 5px; ">
                                        <button type="button" class="btn btn-primary" onclick="AddRow()" style="width:100%">Thêm</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-12 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-2">
                                </label>
                                <div class="col-lg-10">
                                    <table id="auditworktable" class="table table-striped table-bordered zero-configuration" style="width: 100% !important">
                                        <thead class="contain-header-custom m-gray ">
                                            <tr>
                                                <th class="text-center">Tên kiểm toán viên</th>
                                                <th class="text-center"> Ngày bắt đầu tham gia</th>
                                                <th class="text-center">Ngày kết thúc tham gia</th>
                                                <th class="text-center"> Tác vụ</th>
                                            </tr>
                                        </thead>
                                        <tbody id="auditworkbody" class="contain-tbody-custom ">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-12 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-2">
                                    Yêu cầu về kỹ năng kiểm toán
                                </label>
                                <div class="col-lg-10">
                                    <input type="text" class="form-control" id="ReqSkillForAudit" name="ReqSkillForAudit">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-12 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-2">
                                    Yêu cầu thuê ngoài
                                </label>
                                <div class="col-lg-10">
                                    <input type="text" class="form-control" id="ReqOutsourcing" name="ReqOutsourcing">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-12 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-2">
                                    Yêu cầu khác
                                </label>
                                <div class="col-lg-10">
                                    <input type="text" class="form-control" id="ReqOther" name="ReqOther">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Quy mô cuộc KT
                                </label>
                                <div class="col-lg-8">
                                    <select class="form-control" id="ScaleOfAudit">
                                        <option value="-1">---Chọn---</option>
                                        <option value="0">Rất lớn</option>
                                        <option value="1">Lớn</option>
                                        <option value="2">Trung bình</option>
                                        <option value="3">Nhỏ</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    File đính kèm
                                </label>
                                <div class="col-lg-8">
                                    <input type="file" class="form-control" id="FileDinhKem" name="FileDinhKem">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 row-custom">
                        <div class="col-md-6 mb-3">
                            <div class="form-group row">
                                <label class="col-form-label col-lg-4">
                                    Phạm vi kiểm toán
                                </label>
                                <div class="col-lg-8">
                                    <div style="display: inline-flex; flex-direction: row; justify-content: center; align-items: flex-start; padding: 0 5px 0 5px; ">
                                        <button type="button" class="btn btn-primary" style="width:100%">Chọn phạm vi</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12" style="display: inline-flex; flex-direction: row; justify-content: end; align-items: flex-start; width: 100%;">
                        <div style="width: 50%; display: inline-flex; flex-direction: row; justify-content: end; align-items: flex-start;">
                            <div style="width: 24%; display: inline-flex; flex-direction: row; justify-content: center; align-items: flex-start; padding: 0 5px 0 5px; ">
                                <button type="submit" class="btn btn-primary" style="width:100%">@Resource.Save</button>
                            </div>
                            <div style="width: 24%; display: inline-flex; flex-direction: row; justify-content: center; align-items: flex-start; padding: 0 5px 0 5px; ">
                                <button type="button" class="btn btn-default m-back" style="width:100%" onclick="window.history.back();">@Resource.Back</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div hidden>
    <partial name="_Pagination" />
</div>
@section Scripts{
    <script src="~/js/constant.js" asp-append-version="true"></script>
    <script src="~/js/jsApp/auditwork.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/jsApp/common.js" asp-append-version="true"></script>
    <script type="text/javascript">
        $("#StartDate , #EndDate").bootstrapMaterialDatePicker({
            time: false,
            format: 'DD/MM/YYYY',
        });
        callApi_multipleselect("PersonInCharge", "Chọn người phụ trách..", apiConfig.api.host_user_service, apiConfig.api.systemuser.controller, apiConfig.api.systemuser.action.select.path);
         var count = @item;
        AddRow();
        $("#auditworktable").dataTable({
            "bPaginate": false,
            "bLengthChange": false,
            "bFilter": false,
            "bInfo": false,
            "columnDefs": [
                {
                    "targets": [0,1,2,3],
                    "searchable": false,
                    "orderable": false
                }
            ],
            "order": [],
        })
        function AddRow() {

            var table_row = "";
            table_row += '<tr> ' +
                ' <td><select class="form-control usersid" id="Users_' + count + '" name="Users_' + count +'" style="padding:0;"></td>' +
                ' <td><input type="text" class="form-control picker start_date" id="StartDate_' + count + '" name="StartDate_' + count + '" style="padding:0;"></td>' +
                ' <td><input type="text" class="form-control picker end_date" id="EndDate_' + count + '" name="EndDate_' + count + '" style="padding:0;"></td>' +
                '<td class="col-action">' +

               (count != 0 ? '<button type="button" class="btn btn-danger btn-action-custom" onclick="DeleteRow(this)"><i data-toggle="tooltip" title="Xóa" class="fa fa-trash" aria-hidden="true" style="font-size: 16px;"></i></button>' : "") +
            '</td>' +
                ' </tr>';
            $("#auditworkbody").append(table_row);
            callApi_multipleselect("Users_" + count, "Chọn người dùng..", apiConfig.api.host_user_service, apiConfig.api.systemuser.controller, apiConfig.api.systemuser.action.select.path);
            $("#StartDate_" + count).bootstrapMaterialDatePicker({
                time: false,
                format: 'DD/MM/YYYY',
            });
            $("#EndDate_" + count).bootstrapMaterialDatePicker({
                time: false,
                format: 'DD/MM/YYYY',
            });
           
            count++;
        }
        function DeleteRow(element) {
            var $tr = $(element).closest("tr");
            $tr.remove();
        }
    </script>
}